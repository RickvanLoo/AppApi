<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://unpkg.com/onsenui/css/onsenui.css">
    <link rel="stylesheet" href="https://unpkg.com/onsenui/css/onsen-css-components.min.css">
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>

    <script src="https://unpkg.com/onsenui/js/onsenui.min.js"></script>
    <script src="https://unpkg.com/vue-onsenui@2.5.1/dist/vue-onsenui.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue-resource@1.5.0"></script>



</head>
<body>
<div id="app">
    <template id="main-page">
        <v-ons-page>
            <v-ons-toolbar>
                <div class="center"><img src="ocio.png" height="100%"></div>

            </v-ons-toolbar>
            <v-ons-card>
                <v-ons-row>
                    <v-ons-col width="40px" style="text-align: center; line-height: 31px;">
                        <v-ons-icon icon="md-volume-down"></v-ons-icon>
                    </v-ons-col>
                    <v-ons-col>

                        <v-ons-range  v-on:change="sendData()" v-model="player.volume" style="width: 100%;"></v-ons-range>

                    </v-ons-col>
                    <v-ons-col width="40px" style="text-align: center; line-height: 31px;">
                        <v-ons-icon icon="md-volume-up"></v-ons-icon>
                    </v-ons-col>
                </v-ons-row>
            </v-ons-card>
            <v-ons-card>
                <img :src="player.albumCover" style="width: 100%">
                <div class="title" >
                    {{player.status }}: {{player.title}} <br>  <h3>{{player.artist}}</h3>
                </div>

                <div class="content">
                    <div style="margin: 20px auto;">
                        <ons-row>
                            <ons-col width="40px" style="text-align: center; line-height: 31px;">
                                {{player.currentTime}}
                            </ons-col>
                            <ons-col>
                                <ons-range style="width: 100%;" :value="player.elapsedTime"></ons-range>
                            </ons-col>
                            <ons-col width="40px" style="text-align: center; line-height: 31px;">
                                {{player.totalTime}}
                            </ons-col>
                        </ons-row>
                    </div>
                    <div>
                        <v-ons-button><v-ons-icon icon="fa-play"></v-ons-icon></v-ons-button>
                        <v-ons-button><v-ons-icon icon="fa-stop"></v-ons-icon></v-ons-button>
                        <v-ons-button><v-ons-icon icon="fa-backward"></v-ons-icon></v-ons-button>
                        <v-ons-button><v-ons-icon icon="fa-forward"></v-ons-icon></v-ons-button>
                        <v-ons-button><v-ons-icon icon="fa-random"></v-ons-icon></v-ons-button>
                    </div>
                </div>
            </v-ons-card>
        </v-ons-page>
    </template>

</div>

<script>
    var vm = new Vue({
        el: '#app',
        template: '#main-page',
        data: {'player': {
                'status': 'No Status',
                'volume': 0,
                'artist': 'No Data',
                'title': 'No Data',
                'albumCover': 'http://i0.kym-cdn.com/entries/icons/facebook/000/007/333/276751_119503071478225_2986698_n.jpg',
                'totalTime': '99:99',
                'currentTime': '00:00',
                'elapsedTime': 0
            }},

        created: function () {
            this.fetchData();
        },

        methods: {
            fetchData: function () {
                this.$http.get('http://localhost:8000/player')
                    .then(response => {
                    this.player = response.body[0]
                //this.volume = response.body[0].volume

            })
            },

            sendData: function() {
                this.$http.post('http://localhost:8000/player', this.player)
            }
        },

        mounted: function () {
            this.fetchData();

            setInterval(function () {
                this.fetchData();
            }.bind(this), 10000);
        }
    });

</script>
</body>
</html>
